---
title: "Group 11 Final Presentation"
author: "Tom Tribe, Ken MacIver, Jundi Yang, Mei Huang"
date: "2022-09-28"
output: beamer_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


```{r, echo=FALSE, message=FALSE, warning = FALSE}
# load required packages
library(ggplot2)
library(GGally)
library(moments)


```

```{r, echo=FALSE}
diamonds <- read.csv("./diamonds.csv", encoding = "UTF-8")
diamonds$X <- NULL
# Set categorical variables as factors and set levels
diamonds$cut <- factor(diamonds$cut, 
                       levels = c("Fair","Good","Very Good","Premium","Ideal"))
diamonds$color <- factor(diamonds$color, 
                         levels = c("J","I","H","G","F","E","D"))
diamonds$clarity <- factor(diamonds$clarity,
                           levels = c("I1","SI2","SI1","VS2","VS1","VVS2","VVS1","IF"))
# Make data frame of just the numerical variables
diamonds_num <- subset(diamonds, select = c(carat,depth,table,price,x,y,z))
```

# Group 11: Diamonds Dataset

![](./Diamonds.jpg)

# Group Members (photos)

![](./Photos3.jpg)

# Group Members (name, email, ORCID)

Tom Tribe

- tom.tribe2016@gmail.com
- 0000-0002-5002-8066

Ken MacIver

- ken.maciver68@gmail.com
- 0000-0001-8999-4598

Jundi Yang

- ivyli112358@gmail.com
- 0000-0003-0888-9564

Mei Huang

- huangmei139@gmail.com
- 0000-0003-2401-0679


# The Diamonds dataset

- This large dataset has 53940 rows (diamonds) of ten variables (approx 540,000 values)\linebreak 
- Slow to process!\linebreak
- Nine of the variables are various measures of diamond size and quality, while the tenth is the price\linebreak
- We selected diamonds because it was simple to understand what each variable was measuring, and to have the opportunity to work with a large dataset\linebreak
- Particularly interested in which variables are most predictive of diamond price


# The Variables
 \textcolor{red}{red font = categorical variable}
 
-   carat: the diamond's weight
-   \textcolor{red}{cut: a measure of quality (4 levels)}
-   \textcolor{red}{color: a measure of colour quality (7 levels)}
-   \textcolor{red}{clarity: a measure of clearness (6 levels)}
-   x: length in mm
-   y: width in mm 
-   z: depth in mm
-   depth: total depth percentage
-   table: width of top of diamond relative to widest point
-   price: the price of the diamond in US dollars 

(List adapted from list at kaggle.com).

# Summary of Numeric Variables 

|                   |    carat|    depth|    table|    price|        x|        y|        z|
|:------------------|--------:|--------:|--------:|--------:|--------:|--------:|--------:|
|sample size        |    53940|    53940|    53940|    53940|    53940|    53940|    53940|
|minimum            |     0.20|    43.00|    43.00|   326.00|     0.00|     0.00|     0.00|
|first quartile     |     0.40|    61.00|    56.00|   950.00|     4.71|     4.72|     2.91|
|median             |     0.70|    61.80|    57.00|  2401.00|     5.70|     5.71|     3.53|
|mean               |     0.80|    61.75|    57.46|  3932.80|     5.73|     5.73|     3.54|
|third quartile     |     1.04|    62.50|    59.00|  5324.25|     6.54|     6.54|     4.04|
|maximum            |     5.01|    79.00|    95.00| 18823.00|    10.74|    58.90|    31.80|
|IQR                |     0.64|     1.50|     3.00|  4374.25|     1.83|     1.82|     1.13|
|standard deviation |     0.47|     1.43|     2.23|  3989.44|     1.12|     1.14|     0.71|
|skewness           |     1.12|    -0.08|     0.80|     1.62|     0.38|     2.43|     1.52|
|kurtosis           |     4.26|     8.74|     5.80|     5.18|     2.38|    94.21|    50.08|


# Cateogrical Summary

\begin{table}[ht]
\centering
\begin{tabular}{rrrrrr}
  \hline
 Cut\vline & Fair & Good & Very Good & Ideal & Premium \\ 
  \hline
Count\vline & 1610 & 4960 & 12082 & 21551 & 13791\\
   \hline
\end{tabular}
\end{table}

\begin{table}[ht]
\centering
\begin{tabular}{rrrrrrrr}
  \hline
 Color\vline & D & E & F & G & H & I & J \\ 
  \hline
 Count\vline & 6775 & 9797 & 9542 & 11292 & 8304 & 5422 & 2808\\
   \hline
\end{tabular}
\end{table}

\begin{table}[ht]
\centering
\begin{tabular}{rrrrrrrrr}
  \hline
 Clarity\vline & I1 & IF & SI1 & SI2 & VS1 & VS2 & VVS1 & VVS2 \\ 
  \hline
  Count\vline & 741 & 1790 & 13065 & 9194 & 8171 & 12258 & 3655 & 5066\\
   \hline
\end{tabular}
\end{table}


# Pairs Plot

![Pairs plot](./pairs plot.jpg)

# Normal QQ Plots

![Normal QQ Plots](./Normal QQ Plots.jpeg)

# Correlation Plot

![Correlation Plot](./Corrplot_diamonds.jpg)

# Price by Cateogrical 

![Price by Categorical](./pricebycategorical.jpeg)

# Leading Question 1

- How can we best predict diamond price?\linebreak 
- We intend to use the following techniques to investigate this question:\linebreak
- Stepwise Regression, Principal Components Analysis, Principal Components Regression and an Exploratory Factor Analysis\linebreak

# Multiple Regression

- Starting with the full model we used a stepwise regression procedure to find the best model for predicting diamond price.\linebreak
- According to AIC the best model was:\linebreak
- price ~ carat + cut + color + clarity + depth + table + x\linebreak 
- All variables excluding y and z are significant in the model\linebreak
- The 'best' model had an Adjusted $R^2$ of 91.98%\linebreak 

# Regression Assumptions

![Regression Diagnostics](./Regression Diagnostics.jpeg)

# Principal Components Analysis: Screeplot

```{r, echo = FALSE}
set.seed(300525287, kind = "Mersenne-Twister")
smallersample <- diamonds_num[sample(nrow(diamonds_num), "500"), ]
PCA <- prcomp(smallersample, center = TRUE, scale = TRUE)
```

![PCA Screeplot](./PCA screeplot.jpg)


# Principal Components Analysis: Values 

```{r}
PCA$rotation[,1:2]
```

# Biplot

![PCA Biplot](./Biplot PCA.jpeg){height=85%}

# Principal Components Regression

- We conducted a Principal Components Regression with diamond price as the response variable\linebreak
- We found that all six principal components were significant in the model for predicting price\linebreak
- However when we only used the first two principal components we were still able to explain over 80% of the variation in price\linebreak 


# Factor Analysis 

- We hypothesized that the variation in the data might be able to be explained by two factors\linebreak
- These were: "Dimension x Price" and "Light Conductance"\linebreak
- We tested this hypothesis with a Factor Analysis\linebreak
